<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Field Hunter"><title>Field Hunter Pro</title><style>*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}:root{--orange:#f97316;--charcoal:#0a0a0a;--slate:#1a1a1a;--steel:#2a2a2a;--silver:#a3a3a3;--critical:#ef4444;--silicone:#3b82f6;--good:#22c55e}body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;background:var(--charcoal);color:#fff;min-height:100vh}.header{position:sticky;top:0;z-index:100;background:rgba(10,10,10,.95);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.1);padding:env(safe-area-inset-top) 16px 0}.header-content{display:flex;align-items:center;justify-content:space-between;padding:12px 0}.logo{display:flex;align-items:center;gap:12px}.logo-icon{width:44px;height:44px;background:var(--orange);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px}.logo-text h1{font-size:18px}.logo-text p{font-size:12px;color:var(--silver)}.tabs{display:flex;border-top:1px solid rgba(255,255,255,.1)}.tab{flex:1;padding:14px;background:0 0;border:none;color:var(--silver);font-size:14px;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;border-bottom:2px solid transparent}.tab.active{color:var(--orange);border-bottom-color:var(--orange)}.main{padding:20px}.radar-container{background:var(--slate);border-radius:20px;padding:24px;border:1px solid rgba(255,255,255,.1)}.radar-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}.radar-status{display:flex;align-items:center;gap:10px}.radar-dot{width:12px;height:12px;border-radius:50%;background:var(--steel)}.radar-dot.tracking{background:var(--silicone)}.radar-dot.dwelling{background:var(--orange);animation:pulse 1s infinite}.radar-dot.captured{background:var(--good)}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}.radar{position:relative;width:240px;height:240px;margin:0 auto 24px}.radar-circle{position:absolute;border-radius:50%;border:1px solid rgba(255,255,255,.1)}.radar-circle:nth-child(1){inset:0}.radar-circle:nth-child(2){inset:15%}.radar-circle:nth-child(3){inset:30%}.radar-circle:nth-child(4){inset:45%}.radar-sweep{position:absolute;top:50%;left:50%;width:50%;height:2px;transform-origin:left center;background:linear-gradient(90deg,rgba(59,130,246,.8) 0,transparent 100%);animation:sweep 2s linear infinite;display:none}.radar-sweep.active{display:block}.radar-sweep.dwelling{background:linear-gradient(90deg,rgba(249,115,22,.8) 0,transparent 100%)}@keyframes sweep{from{transform:rotate(0)}to{transform:rotate(360deg)}}.radar-center{position:absolute;inset:35%;border-radius:50%;background:var(--steel);display:flex;align-items:center;justify-content:center;font-size:32px}.radar-center.tracking{background:var(--silicone)}.radar-center.dwelling{background:var(--orange)}.radar-center.captured{background:var(--good)}.progress-ring{position:absolute;inset:-5%;transform:rotate(-90deg)}.progress-ring circle{fill:none;stroke-width:4;stroke-linecap:round}.progress-ring .bg{stroke:rgba(249,115,22,.2)}.progress-ring .progress{stroke:var(--orange)}.stats{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:24px}.stat{background:rgba(255,255,255,.05);border-radius:16px;padding:16px}.stat-label{font-size:11px;color:var(--silver);text-transform:uppercase;margin-bottom:4px}.stat-value{font-size:28px;font-weight:700}.stat-value span{font-size:14px;color:var(--silver)}.stat.full{grid-column:span 2}.stat.full .stat-value{font-size:16px}.stat-sub{font-size:12px;color:var(--silver);margin-top:4px}.control-btn{width:100%;padding:18px;border-radius:16px;border:none;font-size:18px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;min-height:60px}.control-btn.start{background:var(--orange);color:#fff}.control-btn.stop{background:rgba(239,68,68,.2);color:#ef4444;border:1px solid rgba(239,68,68,.5)}.leads-empty{text-align:center;padding:60px 20px}.leads-empty-icon{width:80px;height:80px;background:var(--steel);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:36px}.leads-empty h3{font-size:20px;margin-bottom:8px}.leads-empty p{color:var(--silver);font-size:14px}.lead-card{background:var(--slate);border-radius:20px;overflow:hidden;border:1px solid rgba(255,255,255,.1);margin-bottom:16px}.lead-header{padding:20px;position:relative}.lead-address{display:flex;gap:10px;padding-right:80px}.lead-address h3{font-size:18px;font-weight:600}.lead-stats{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px}.lead-stat{font-size:13px;color:var(--silver)}.lead-stat strong{color:#fff}.score-badge{position:absolute;top:16px;right:16px;width:70px;height:70px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center}.score-badge.critical{background:var(--critical);box-shadow:0 0 30px rgba(239,68,68,.5)}.score-badge.silicone{background:var(--silicone);box-shadow:0 0 30px rgba(59,130,246,.5)}.score-badge.good{background:var(--good);box-shadow:0 0 30px rgba(34,197,94,.5)}.score-badge .score{font-size:28px;font-weight:700}.score-badge .label{font-size:9px;font-weight:600}.roi-section{padding:0 20px;border-top:1px solid rgba(255,255,255,.1)}.roi-header{display:flex;align-items:center;justify-content:space-between;padding:16px 0;cursor:pointer}.roi-header strong{font-size:16px}.roi-details{padding-bottom:20px;display:none}.roi-details.open{display:block}.roi-option{border-radius:16px;padding:16px;margin-bottom:12px}.roi-option.tpo{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3)}.roi-option.silicone{background:rgba(34,197,94,.1);border:1px solid rgba(34,197,94,.3)}.roi-option-header{display:flex;justify-content:space-between;margin-bottom:10px}.roi-option.tpo .roi-option-title{color:#f87171}.roi-option.silicone .roi-option-title{color:#4ade80}.roi-option-title{font-weight:600}.roi-option-net{font-size:20px;font-weight:700}.roi-line{display:flex;justify-content:space-between;font-size:13px;color:var(--silver);margin-bottom:4px}.roi-note{font-size:12px;margin-top:8px;color:var(--silver)}.roi-option.silicone .roi-note{color:#4ade80;font-weight:500}.roi-summary{background:rgba(249,115,22,.2);border:1px solid rgba(249,115,22,.5);border-radius:16px;padding:16px;text-align:center}.roi-summary-label{font-size:12px;color:var(--orange)}.roi-summary-value{font-size:32px;font-weight:700;margin:4px 0}.roi-summary-sub{font-size:13px;color:var(--silver)}.lead-actions{padding:20px;border-top:1px solid rgba(255,255,255,.1)}.action-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.action-btn{background:var(--steel);border:none;border-radius:16px;padding:16px 12px;display:flex;flex-direction:column;align-items:center;gap:6px;color:var(--silver);min-height:70px}.action-btn .icon{font-size:24px}.action-btn .label{font-size:12px}.action-btn.primary{background:var(--orange);color:#fff}.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(8px);z-index:200;display:none;align-items:flex-end;justify-content:center;padding:16px}.modal-overlay.open{display:flex}.modal{background:var(--charcoal);border-radius:24px 24px 0 0;width:100%;max-width:500px;max-height:90vh;overflow-y:auto}.modal-header{position:sticky;top:0;background:var(--charcoal);padding:24px;border-bottom:1px solid rgba(255,255,255,.1);display:flex;align-items:center;justify-content:space-between}.modal-header-left{display:flex;align-items:center;gap:12px}.modal-icon{width:48px;height:48px;background:var(--good);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;animation:pulse 1s infinite}.modal-header h2{font-size:20px}.modal-header p{font-size:13px;color:var(--silver)}.modal-close{width:40px;height:40px;background:var(--steel);border:none;border-radius:50%;color:var(--silver);font-size:20px;cursor:pointer}.modal-content{padding:24px}.modal-address{background:var(--slate);border-radius:16px;padding:16px;margin-bottom:24px}.modal-section h3{font-size:12px;color:var(--silver);text-transform:uppercase;margin-bottom:12px}.modal-input{width:100%;padding:16px;background:var(--steel);border:none;border-radius:16px;color:#fff;font-size:18px;margin-bottom:16px}.modal-input:focus{outline:2px solid var(--orange)}.sqft-buttons{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:12px}.sqft-btn{padding:12px;background:var(--steel);border:none;border-radius:12px;color:var(--silver);font-size:14px}.sqft-btn.active{background:var(--orange);color:#fff}.modal-actions{padding:24px;border-top:1px solid rgba(255,255,255,.1)}.save-btn{width:100%;padding:18px;background:var(--good);border:none;border-radius:16px;color:#fff;font-size:18px;font-weight:600;margin-bottom:12px}.dismiss-btn{width:100%;padding:14px;background:0 0;border:none;color:var(--silver);font-size:16px}.preview-card{background:var(--slate);border-radius:16px;padding:16px;margin-top:20px}.preview-header{display:flex;justify-content:space-between;margin-bottom:16px}.preview-score{width:56px;height:56px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center}.preview-score .num{font-size:22px;font-weight:700}.preview-score .lbl{font-size:8px}.preview-roi{background:rgba(249,115,22,.15);border-radius:12px;padding:12px;text-align:center}.preview-roi-label{font-size:11px;color:var(--orange)}.preview-roi-value{font-size:24px;font-weight:700}.preview-roi-sub{font-size:11px;color:var(--silver)}.delete-btn{position:absolute;top:16px;left:16px;width:32px;height:32px;background:rgba(239,68,68,.2);border:none;border-radius:50%;color:#f87171;font-size:16px}</style></head><body><div id="app"><header class="header"><div class="header-content"><div class="logo"><div class="logo-icon">üéØ</div><div class="logo-text"><h1>Field Hunter Pro</h1><p>Dalmex Routes</p></div></div><div style="display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--steel);border-radius:20px;font-size:12px"><div class="radar-dot" id="statusDot"></div><span id="onlineStatus">Online</span></div></div><div class="tabs"><button class="tab active" id="radarTab" onclick="showTab('radar')">üìç Radar</button><button class="tab" id="leadsTab" onclick="showTab('leads')">üìã Leads (<span id="leadCount">0</span>)</button></div></header><main class="main" id="radarView"><div class="radar-container"><div class="radar-header"><div class="radar-status"><div class="radar-dot" id="radarDot"></div><span id="statusText">Ready to Hunt</span></div><div style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--silver)"><span id="connectionIcon">üì∂</span><span id="connectionText">Online</span></div></div><div class="radar"><div class="radar-circle"></div><div class="radar-circle"></div><div class="radar-circle"></div><div class="radar-circle"></div><div class="radar-sweep" id="radarSweep"></div><svg class="progress-ring" viewBox="0 0 100 100"><circle class="bg" cx="50" cy="50" r="45"/><circle class="progress" cx="50" cy="50" r="45" stroke-dasharray="283" stroke-dashoffset="283" id="progressCircle"/></svg><div class="radar-center" id="radarCenter">üß≠</div></div><div class="stats"><div class="stat"><div class="stat-label">‚ö° Speed</div><div class="stat-value"><span id="speedValue">--</span> <span>mph</span></div></div><div class="stat"><div class="stat-label">‚è± Dwell</div><div class="stat-value" id="dwellTime">0:00</div></div><div class="stat full" id="locationStat" style="display:none"><div class="stat-label">üìç Location</div><div class="stat-value" id="locationValue">--</div><div class="stat-sub" id="accuracyValue"></div></div></div><button class="control-btn start" id="controlBtn" onclick="toggleTracking()">üß≠ Start Route</button></div></main><main class="main" id="leadsView" style="display:none"><div id="leadsContainer"><div class="leads-empty" id="leadsEmpty"><div class="leads-empty-icon">üìç</div><h3>No Leads Yet</h3><p>Start your route to capture leads.</p></div></div></main><div class="modal-overlay" id="captureModal"><div class="modal"><div class="modal-header"><div class="modal-header-left"><div class="modal-icon">üìç</div><div><h2>Lead Captured!</h2><p id="modalDwellTime">2m here</p></div></div><button class="modal-close" onclick="dismissCapture()">‚úï</button></div><div class="modal-content"><div class="modal-address"><strong id="addressText">Looking up...</strong><p id="cityStateText" style="color:var(--silver);margin-top:4px"></p></div><div class="modal-section"><h3>Assessment</h3><label style="display:block;font-size:14px;color:var(--silver);margin-bottom:8px">Year Built</label><input type="number" class="modal-input" id="yearInput" placeholder="e.g. 2005"><label style="display:block;font-size:14px;color:var(--silver);margin-bottom:8px">Roof Sqft</label><div class="sqft-buttons"><button class="sqft-btn" onclick="setSqft(5000)">5K</button><button class="sqft-btn" onclick="setSqft(10000)">10K</button><button class="sqft-btn" onclick="setSqft(20000)">20K</button><button class="sqft-btn" onclick="setSqft(50000)">50K</button></div><input type="number" class="modal-input" id="sqftInput" placeholder="Exact sqft"></div><div class="preview-card" id="previewCard" style="display:none"><div class="preview-header"><div><div style="font-weight:600" id="previewAddress">Address</div><div style="font-size:13px;color:var(--silver)" id="previewDetails"></div></div><div class="preview-score" id="previewScore"><div class="num">?</div><div class="lbl">SCORE</div></div></div><div class="preview-roi" id="previewROI" style="display:none"><div class="preview-roi-label">YEAR 1 SAVINGS</div><div class="preview-roi-value" id="previewSavings">$0</div><div class="preview-roi-sub">silicone vs TPO</div></div></div></div><div class="modal-actions"><button class="save-btn" onclick="saveLead()">‚úì Save Lead</button><button class="dismiss-btn" onclick="dismissCapture()">Dismiss</button></div></div></div></div><script>let s={status:'IDLE',isTracking:!1,pos:null,speed:null,dwellStart:null,dwellDur:0,leads:[],capture:null,watchId:null,buf:[]};const C={SPD:2,DUR:120000,MPM:1609.34};document.addEventListener('DOMContentLoaded',()=>{loadLeads();updateUI();window.addEventListener('online',()=>connStatus(!0));window.addEventListener('offline',()=>connStatus(!1));connStatus(navigator.onLine);document.getElementById('yearInput').addEventListener('input',updatePreview);document.getElementById('sqftInput').addEventListener('input',updatePreview)});function toggleTracking(){s.isTracking?stopTrack():startTrack()}function startTrack(){if(!navigator.geolocation){alert('GPS not supported');return}s.isTracking=!0;s.status='TRACKING';s.buf=[];s.watchId=navigator.geolocation.watchPosition(handlePos,handleErr,{enableHighAccuracy:!0,timeout:10000,maximumAge:0});updateUI()}function stopTrack(){if(s.watchId!==null){navigator.geolocation.clearWatch(s.watchId);s.watchId=null}s.isTracking=!1;s.status='IDLE';s.speed=null;s.dwellStart=null;s.dwellDur=0;updateUI()}function handlePos(p){const n={lat:p.coords.latitude,lon:p.coords.longitude,acc:p.coords.accuracy,ts:p.timestamp};s.pos=n;s.buf.push(n);if(s.buf.length>10)s.buf.shift();if(s.buf.length>=2){const pr=s.buf[s.buf.length-2];s.speed=calcSpd(pr,n)}const still=s.speed!==null&&s.speed<C.SPD;if(still){if(s.status==='TRACKING'){s.status='DWELLING';s.dwellStart=Date.now();s.dwellDur=0}else if(s.status==='DWELLING'){s.dwellDur=Date.now()-s.dwellStart;if(s.dwellDur>=C.DUR&&!s.capture)triggerCap()}}else{if(s.status==='DWELLING'){s.status='TRACKING';s.dwellStart=null;s.dwellDur=0}}updateUI()}function handleErr(e){if(e.code===1)alert('Location denied');else if(e.code===2)alert('Position unavailable')}function calcSpd(a,b){const R=6371e3;const l1=a.lat*Math.PI/180;const l2=b.lat*Math.PI/180;const dL=(b.lat-a.lat)*Math.PI/180;const dO=(b.lon-a.lon)*Math.PI/180;const x=Math.sin(dL/2)*Math.sin(dL/2)+Math.cos(l1)*Math.cos(l2)*Math.sin(dO/2)*Math.sin(dO/2);const c=2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));const d=R*c;const t=(b.ts-a.ts)/1000;if(t<=0)return 0;return Math.max(0,(d/t)*3600/C.MPM)}function triggerCap(){s.status='CAPTURED';s.capture={id:'l_'+Date.now(),coords:{...s.pos},dur:s.dwellDur,ts:new Date().toISOString()};if('vibrate'in navigator)navigator.vibrate([200,100,200]);revGeo(s.pos);document.getElementById('captureModal').classList.add('open');document.getElementById('modalDwellTime').textContent=fmtDur(s.dwellDur)+' here';document.getElementById('yearInput').value='';document.getElementById('sqftInput').value='';document.querySelectorAll('.sqft-btn').forEach(b=>b.classList.remove('active'));document.getElementById('previewCard').style.display='none';updateUI()}async function revGeo(c){const a=document.getElementById('addressText');const cs=document.getElementById('cityStateText');a.textContent='Looking up...';cs.textContent='';try{const r=await fetch('https://nominatim.openstreetmap.org/reverse?format=json&lat='+c.lat+'&lon='+c.lon);const d=await r.json();if(d&&d.display_name){const p=d.display_name.split(', ');a.textContent=p.slice(0,2).join(', ');cs.textContent=p.slice(2,5).join(', ');if(s.capture)s.capture.addr=d.display_name}else{a.textContent=c.lat.toFixed(6)+', '+c.lon.toFixed(6);cs.textContent='N/A'}}catch(e){a.textContent=c.lat.toFixed(6)+', '+c.lon.toFixed(6);cs.textContent='Offline'}updatePreview()}function setSqft(v){document.getElementById('sqftInput').value=v;document.querySelectorAll('.sqft-btn').forEach(b=>b.classList.toggle('active',parseInt(b.textContent)*1000===v));updatePreview()}function updatePreview(){const y=document.getElementById('yearInput').value?parseInt(document.getElementById('yearInput').value):null;const sq=document.getElementById('sqftInput').value?parseInt(document.getElementById('sqftInput').value):null;const sc=calcScore(y,sq);document.getElementById('previewCard').style.display='block';document.getElementById('previewAddress').textContent=document.getElementById('addressText').textContent;let d=[];if(y)d.push('Built '+y+' ('+(new Date().getFullYear()-y)+' yrs)');if(sq)d.push(sq.toLocaleString()+' sqft');document.getElementById('previewDetails').textContent=d.join(' ‚Ä¢ ');const sb=document.getElementById('previewScore');sb.querySelector('.num').textContent=sc.v;sb.querySelector('.lbl').textContent=sc.l;sb.style.background=sc.c;sb.style.boxShadow='0 0 20px '+sc.c+'66';const rs=document.getElementById('previewROI');if(sq){const roi=calcROI(sq);rs.style.display='block';document.getElementById('previewSavings').textContent='$'+roi.sav.toLocaleString()}else{rs.style.display='none'}if(s.capture){s.capture.year=y;s.capture.sqft=sq;s.capture.score=sc}}function calcScore(y,sq){const age=y?new Date().getFullYear()-y:null;let pts=0;if(age!==null){if(age>=20)pts+=4;else if(age>=10&&age<=15)pts+=2}if(age&&age>10)pts+=3;if(sq&&sq>20000)pts+=1;const v=Math.min(10,Math.max(1,pts));let l,c;if(v>=8){l='CRITICAL';c='#ef4444'}else if(v>=5){l='SILICONE';c='#3b82f6'}else{l='NEWER';c='#22c55e'}return{v,l,c}}function calcROI(sq){const tC=sq*12;const tT=(tC/39)*0.21;const tN=tC-tT;const sC=sq*4;const sT=sC*0.21;const sN=sC-sT;return{tN:Math.round(tN),sN:Math.round(sN),sav:Math.round(tN-sN)}}function saveLead(){if(!s.capture)return;const l={...s.capture,year:parseInt(document.getElementById('yearInput').value)||null,sqft:parseInt(document.getElementById('sqftInput').value)||null,score:calcScore(parseInt(document.getElementById('yearInput').value),parseInt(document.getElementById('sqftInput').value)),addr:document.getElementById('addressText').textContent};if(l.sqft)l.roi=calcROI(l.sqft);s.leads.unshift(l);saveLeads();dismissCapture();showTab('leads')}function dismissCapture(){document.getElementById('captureModal').classList.remove('open');s.capture=null;s.status='TRACKING';s.dwellStart=null;s.dwellDur=0;updateUI()}function saveLeads(){localStorage.setItem('fhLeads',JSON.stringify(s.leads));updateLeadCount();renderLeads()}function loadLeads(){const x=localStorage.getItem('fhLeads');if(x)s.leads=JSON.parse(x);updateLeadCount();renderLeads()}function deleteLead(id){s.leads=s.leads.filter(l=>l.id!==id);saveLeads()}function updateLeadCount(){document.getElementById('leadCount').textContent=s.leads.length}function renderLeads(){const c=document.getElementById('leadsContainer');const e=document.getElementById('leadsEmpty');if(s.leads.length===0){c.innerHTML='';c.appendChild(e);e.style.display='block';return}e.style.display='none';c.innerHTML=s.leads.map(l=>{const sc=l.score||{v:'?',l:'CHECK',c:'#2a2a2a'};const cls=sc.l==='CRITICAL'?'critical':sc.l==='SILICONE'?'silicone':'good';return'<div class="lead-card"><div class="lead-header"><button class="delete-btn" onclick="deleteLead(\''+l.id+'\')">üóë</button><div class="lead-address"><span style="color:var(--orange);font-size:20px">üìç</span><div><h3>'+(l.addr||'Unknown')+'</h3></div></div><div class="score-badge '+cls+'"><span class="score">'+sc.v+'</span><span class="label">'+sc.l+'</span></div><div class="lead-stats">'+(l.year?'<span class="lead-stat">üóì <strong>'+l.year+'</strong> ('+(new Date().getFullYear()-l.year)+' yrs)</span>':'')+(l.sqft?'<span class="lead-stat">üè¢ <strong>'+l.sqft.toLocaleString()+'</strong> sqft</span>':'')+'</div></div>'+(l.roi?'<div class="roi-section"><div class="roi-header" onclick="this.nextElementSibling.classList.toggle(\'open\')"><div style="display:flex;align-items:center;gap:10px"><span style="color:var(--good)">üí∞</span><strong>Year 1 Savings: $'+l.roi.sav.toLocaleString()+'</strong></div><span>‚ñº</span></div><div class="roi-details"><div class="roi-option tpo"><div class="roi-option-header"><span class="roi-option-title">TPO Replace</span><span class="roi-option-net">$'+l.roi.tN.toLocaleString()+'</span></div><div class="roi-line"><span>Gross</span><span>$'+(l.sqft*12).toLocaleString()+'</span></div><div class="roi-note">39yr depreciation</div></div><div class="roi-option silicone"><div class="roi-option-header"><span class="roi-option-title">Silicone</span><span class="roi-option-net">$'+l.roi.sN.toLocaleString()+'</span></div><div class="roi-line"><span>Gross</span><span>$'+(l.sqft*4).toLocaleString()+'</span></div><div class="roi-note">‚úì 100% deductible</div></div><div class="roi-summary"><div class="roi-summary-label">ADVANTAGE</div><div class="roi-summary-value">$'+l.roi.sav.toLocaleString()+'</div><div class="roi-summary-sub">'+Math.round((l.roi.sav/l.roi.tN)*100)+'% savings</div></div></div></div>':'')+'<div class="lead-actions"><div class="action-grid"><button class="action-btn"><span class="icon">üì∑</span><span class="label">Photo</span></button><button class="action-btn primary"><span class="icon">üìÑ</span><span class="label">Proposal</span></button><button class="action-btn"><span class="icon">üìû</span><span class="label">Call</span></button></div></div></div>'}).join('')}function showTab(t){document.getElementById('radarTab').classList.toggle('active',t==='radar');document.getElementById('leadsTab').classList.toggle('active',t==='leads');document.getElementById('radarView').style.display=t==='radar'?'block':'none';document.getElementById('leadsView').style.display=t==='leads'?'block':'none'}function connStatus(o){document.getElementById('connectionIcon').textContent=o?'üì∂':'üì°';document.getElementById('connectionText').textContent=o?'Online':'Offline';document.getElementById('onlineStatus').textContent=o?'Online':'Offline'}function updateUI(){const sd=document.getElementById('statusDot');const rd=document.getElementById('radarDot');const st=document.getElementById('statusText');const rc=document.getElementById('radarCenter');const rs=document.getElementById('radarSweep');const cb=document.getElementById('controlBtn');const pc=document.getElementById('progressCircle');const ls=document.getElementById('locationStat');sd.className='radar-dot';rd.className='radar-dot';rc.className='radar-center';rs.className='radar-sweep';switch(s.status){case'IDLE':st.textContent='Ready to Hunt';rc.textContent='üß≠';break;case'TRACKING':sd.classList.add('tracking');rd.classList.add('tracking');rc.classList.add('tracking');rs.classList.add('active');st.textContent='En Route';rc.textContent='üß≠';break;case'DWELLING':sd.classList.add('dwelling');rd.classList.add('dwelling');rc.classList.add('dwelling');rs.classList.add('active','dwelling');st.textContent='Stopping...';rc.textContent='üì°';break;case'CAPTURED':sd.classList.add('captured');rd.classList.add('captured');rc.classList.add('captured');st.textContent='Captured!';rc.textContent='üéØ';break}cb.className=s.isTracking?'control-btn stop':'control-btn start';cb.innerHTML=s.isTracking?'‚ñ† Stop':'üß≠ Start Route';document.getElementById('speedValue').textContent=s.speed!==null?s.speed.toFixed(1):'--';document.getElementById('dwellTime').textContent=fmtDur(s.dwellDur);const prog=Math.min(100,(s.dwellDur/C.DUR)*100);const circ=2*Math.PI*45;pc.style.strokeDashoffset=circ-(prog/100)*circ;if(s.pos){ls.style.display='block';document.getElementById('locationValue').textContent=s.pos.lat.toFixed(6)+', '+s.pos.lon.toFixed(6);document.getElementById('accuracyValue').textContent='¬±'+Math.round(s.pos.acc)+'m'}updateLeadCount()}function fmtDur(ms){const t=Math.floor(ms/1000);const m=Math.floor(t/60);const sec=t%60;return m+':'+sec.toString().padStart(2,'0')}</script></body></html>
