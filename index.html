<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Field Hunter">
<title>Field Hunter Pro v2</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}
:root{--orange:#f97316;--charcoal:#0a0a0a;--slate:#1a1a1a;--steel:#2a2a2a;--silver:#a3a3a3;--critical:#ef4444;--silicone:#3b82f6;--good:#22c55e;--purple:#8b5cf6;--amber:#f59e0b}
body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;background:var(--charcoal);color:#fff;min-height:100vh;padding-bottom:80px}
.header{position:sticky;top:0;z-index:100;background:rgba(10,10,10,.95);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.1);padding:env(safe-area-inset-top) 16px 0}
.header-content{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
.logo{display:flex;align-items:center;gap:12px}
.logo-icon{width:44px;height:44px;background:var(--orange);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px}
.logo-text h1{font-size:18px}.logo-text p{font-size:12px;color:var(--silver)}
.commission-badge{background:var(--good);color:#fff;padding:6px 12px;border-radius:20px;font-size:14px;font-weight:700}
.nav{display:flex;gap:4px;padding:8px 0;overflow-x:auto}
.nav-btn{flex-shrink:0;padding:10px 16px;background:var(--steel);border:none;border-radius:20px;color:var(--silver);font-size:13px;font-weight:500}
.nav-btn.active{background:var(--orange);color:#fff}
.main{padding:16px}
.card{background:var(--slate);border-radius:20px;padding:20px;margin-bottom:16px;border:1px solid rgba(255,255,255,.1)}
.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.card-title{font-size:16px;font-weight:600}
.radar{position:relative;width:200px;height:200px;margin:0 auto 20px}
.radar-circle{position:absolute;border-radius:50%;border:1px solid rgba(255,255,255,.1)}
.radar-circle:nth-child(1){inset:0}.radar-circle:nth-child(2){inset:20%}.radar-circle:nth-child(3){inset:40%}
.radar-sweep{position:absolute;top:50%;left:50%;width:50%;height:2px;transform-origin:left;background:linear-gradient(90deg,rgba(59,130,246,.8),transparent);animation:sweep 2s linear infinite;display:none}
.radar-sweep.active{display:block}
.radar-sweep.dwelling{background:linear-gradient(90deg,rgba(249,115,22,.8),transparent)}
@keyframes sweep{to{transform:rotate(360deg)}}
.radar-center{position:absolute;inset:35%;border-radius:50%;background:var(--steel);display:flex;align-items:center;justify-content:center;font-size:28px}
.radar-center.tracking{background:var(--silicone)}.radar-center.dwelling{background:var(--orange)}.radar-center.captured{background:var(--good)}
.progress-ring{position:absolute;inset:-5%;transform:rotate(-90deg)}
.progress-ring circle{fill:none;stroke-width:4}.progress-ring .bg{stroke:rgba(249,115,22,.2)}.progress-ring .progress{stroke:var(--orange)}
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.stat-box{background:rgba(255,255,255,.05);border-radius:12px;padding:14px}
.stat-label{font-size:10px;color:var(--silver);text-transform:uppercase;margin-bottom:4px}
.stat-value{font-size:22px;font-weight:700}.stat-value span{font-size:12px;color:var(--silver)}
.btn{width:100%;padding:16px;border-radius:14px;border:none;font-size:16px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px}
.btn-primary{background:var(--orange);color:#fff}
.btn-stop{background:rgba(239,68,68,.2);color:#ef4444;border:1px solid rgba(239,68,68,.5)}
.btn-success{background:var(--good);color:#fff}
.btn-secondary{background:var(--steel);color:#fff}
<body><div id="app"><header class="header"><div class="header-content"><div class="logo"><div class="logo-icon">ğŸ¯</div><div class="logo-text"><h1>Field Hunter Pro</h1><p>v2 â€¢ Dalmex Routes</p></div></div><div class="comm-badge" id="commBadge">$0</div></div><div class="nav"><button class="nav-btn active" onclick="showTab('radar')">ğŸ“¡ Radar</button><button class="nav-btn" onclick="showTab('leads')">ğŸ“‹ Leads <span id="leadCountNav">0</span></button><button class="nav-btn" onclick="showTab('commission')">ğŸ’° Commission</button></div></header><main class="main tab active" id="radarTab"><div class="card"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px"><span id="statusText" style="font-weight:600">Ready to Hunt</span><span id="connBadge" style="background:var(--good);padding:4px 10px;border-radius:12px;font-size:12px">ğŸ“¶ Online</span></div><div class="radar"><div class="radar-circle"></div><div class="radar-circle"></div><div class="radar-circle"></div><svg class="progress-ring" viewBox="0 0 100 100"><circle class="bg" cx="50" cy="50" r="45"/><circle class="progress" cx="50" cy="50" r="45" stroke-dasharray="283" stroke-dashoffset="283" id="progressCircle"/></svg><div class="radar-sweep" id="radarSweep"></div><div class="radar-center" id="radarCenter">ğŸ§­</div></div><div class="stats"><div class="stat"><div class="stat-label">âš¡ Speed</div><div class="stat-value"><span id="speedValue">--</span> <span>mph</span></div></div><div class="stat"><div class="stat-label">â±ï¸ Dwell</div><div class="stat-value" id="dwellTime">0:00</div></div><div class="stat"><div class="stat-label">ğŸ“ Today</div><div class="stat-value" id="todayLeads">0</div></div><div class="stat"><div class="stat-label">ğŸ”¥ Hot</div><div class="stat-value" id="hotLeads">0</div></div></div><button class="btn btn-primary" id="controlBtn" onclick="toggleTracking()">ğŸ§­ Start Route</button></div><div class="weather-alert" id="weatherAlert" style="display:none"><div class="icon">â›ˆï¸</div><div><div class="title">Storm Activity Nearby</div><div class="sub" id="weatherText">Hail reported 12 miles away</div></div></div><div class="card" id="locCard" style="display:none"><div style="font-size:14px;color:var(--silver);margin-bottom:8px">ğŸ“ Current Location</div><div id="locText" style="font-size:16px;font-weight:600">--</div><div id="accText" style="font-size:12px;color:var(--silver);margin-top:4px">--</div></div></main><main class="main tab" id="leadsTab"><input type="text" class="input" placeholder="Search leads..." id="searchInput" oninput="filterLeads()" style="margin-bottom:16px"><div id="leadsContainer"><div class="empty" id="leadsEmpty"><div class="empty-icon">ğŸ“</div><h3>No Leads Yet</h3><p style="color:var(--silver)">Start your route to capture leads.</p></div></div></main><main class="main tab" id="commissionTab"><div class="comm-card"><h3 style="font-size:14px;opacity:.9;margin-bottom:12px">ğŸ’° This Month</h3><div class="comm-row"><span>Proposals Sent</span><span id="propCount">0</span></div><div class="comm-row"><span>Deals Closed</span><span id="dealCount">0</span></div><div class="comm-row"><span>Contract Value</span><span id="contractVal">$0</span></div><div class="comm-row total"><span>Commission</span><span id="totalComm">$0</span></div><div class="goal-bar"><div class="goal-fill" id="goalFill" style="width:0%"></div></div><div class="goal-text"><span>Monthly Goal</span><span id="goalText">$0 / $10,000</span></div></div><div class="card"><div style="font-weight:600;margin-bottom:16px">â• Log a Deal</div><div class="input-group"><label>Contract Value</label><input type="number" class="input" id="dealInput" placeholder="e.g. 80000"></div><div class="input-group"><label>Commission Rate</label><div class="quick-btns"><button class="quick-btn active" onclick="setRate(5)">5%</button><button class="quick-btn" onclick="setRate(7)">7%</button><button class="quick-btn" onclick="setRate(10)">10%</button><button class="quick-btn" onclick="setRate(15)">15%</button></div></div><button class="btn btn-success" onclick="logDeal()">ğŸ’° Log Deal</button></div></main></div>
<div class="modal" id="captureModal"><div class="modal-content"><div class="modal-header"><h2>ğŸ¯ Lead Captured!</h2><button class="modal-close" onclick="dismissCapture()">âœ•</button></div><div class="modal-body"><div class="weather-alert" id="modalWeather" style="display:none"><div class="icon">â›ˆï¸</div><div><div class="title">Recent Storm Activity</div><div class="sub">Hail damage reported in this area</div></div></div><div class="section-title">ğŸ“ Location</div><div style="background:var(--steel);border-radius:12px;padding:14px;margin-bottom:16px"><div id="captureAddr" style="font-weight:600">Looking up...</div><div id="captureDwell" style="font-size:13px;color:var(--silver);margin-top:4px">--</div></div><div class="section-title">ğŸ¢ Property Info</div><div class="input-group"><label>Year Built</label><input type="number" class="input" id="yearInput" placeholder="e.g. 2005"></div><div class="input-group"><label>Roof Square Footage</label><div class="quick-btns"><button class="quick-btn" onclick="setSqft(5000)">5K</button><button class="quick-btn" onclick="setSqft(10000)">10K</button><button class="quick-btn" onclick="setSqft(20000)">20K</button><button class="quick-btn" onclick="setSqft(50000)">50K</button></div><input type="number" class="input" id="sqftInput" placeholder="Exact sqft" style="margin-top:8px"></div><div class="input-group"><label>Owner or Tenant?</label><div class="quick-btns"><button class="quick-btn" onclick="setOwner('owner')">Owner</button><button class="quick-btn" onclick="setOwner('tenant')">Tenant</button><button class="quick-btn active" onclick="setOwner('unknown')">Unknown</button></div></div><div class="section-title">ğŸ“· Photos</div><div class="photo-grid" id="photoGrid"><div class="photo-item" onclick="addPhoto()">ğŸ“·</div><div class="photo-item" onclick="addPhoto()">â•</div></div><div class="section-title">ğŸ¤ Voice Note</div><button class="voice-btn" id="voiceBtn" onclick="toggleVoice()">ğŸ¤ Tap to Record</button><textarea class="notes-area" id="notesInput" placeholder="Or type notes..."></textarea><div class="section-title">ğŸšš Competitor Spotted?</div><div style="display:flex;gap:8px"><input type="text" class="input" id="compInput" placeholder="e.g. ABC Roofing" style="flex:1"><button class="btn btn-secondary" onclick="addComp()" style="width:auto;padding:14px 16px">Add</button></div><div id="compList" style="margin-top:8px"></div><div class="section-title">â° Follow-up Reminder</div><div class="reminder-btns"><button class="reminder-btn" onclick="setReminder(1)">Tomorrow</button><button class="reminder-btn" onclick="setReminder(3)">3 Days</button><button class="reminder-btn" onclick="setReminder(7)">1 Week</button><button class="reminder-btn" onclick="setReminder(14)">2 Weeks</button></div><div class="section-title">ğŸ“Š Score & ROI</div><div id="previewBox" style="display:none"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px"><div><div style="font-size:13px;color:var(--silver)">Scout Score</div><div style="font-size:32px;font-weight:700" id="previewScore">?</div></div><div class="score-badge" id="previewBadge" style="position:static"><span class="score" id="badgeNum">?</span><span class="label" id="badgeLabel">SCORE</span></div></div><div class="roi-box" id="roiBox" style="display:none"><div class="roi-option tpo"><div class="roi-header"><span class="roi-title">TPO Replacement</span><span class="roi-value" id="tpoNet">$0</span></div><div style="font-size:12px;color:var(--silver)">Gross: <span id="tpoGross">$0</span> â€¢ 39yr depreciation</div></div><div class="roi-option silicone"><div class="roi-header"><span class="roi-title">Silicone Coating</span><span class="roi-value" id="silNet">$0</span></div><div style="font-size:12px;color:var(--silver)">Gross: <span id="silGross">$0</span> â€¢ 100% Year 1</div></div><div class="roi-summary"><div class="roi-summary-label">YEAR 1 SAVINGS</div><div class="roi-summary-value" id="savingsVal">$0</div><div class="roi-summary-sub" id="savingsPct">0% advantage</div></div></div></div><div style="margin-top:24px"><button class="btn btn-success" onclick="saveLead()" style="margin-bottom:12px">âœ“ Save Lead</button><button class="btn btn-primary" onclick="saveAndProposal()">ğŸ“„ Save & Generate Proposal</button></div></div></div></div>
<div class="modal" id="proposalModal"><div class="modal-content"><div class="modal-header"><h2>ğŸ“„ Proposal</h2><button class="modal-close" onclick="closeProposal()">âœ•</button></div><div class="modal-body" id="proposalBody"></div></div></div></body><script>let S={status:'IDLE',tracking:false,pos:null,speed:null,dwellStart:null,dwellDur:0,leads:[],capture:null,watchId:null,buf:[],photos:[],comps:[],reminder:null,owner:'unknown',recording:false,deals:[],rate:5,goal:10000};const C={SPD:2,DUR:120000,MPM:1609.34};document.addEventListener('DOMContentLoaded',()=>{load();updateUI();checkWeather();window.addEventListener('online',()=>updateConn(true));window.addEventListener('offline',()=>updateConn(false));updateConn(navigator.onLine);document.getElementById('yearInput').addEventListener('input',updatePreview);document.getElementById('sqftInput').addEventListener('input',updatePreview)});function load(){const d=localStorage.getItem('fhv2');if(d){const p=JSON.parse(d);S.leads=p.leads||[];S.deals=p.deals||[];S.goal=p.goal||10000}updateLeadCount();renderLeads();updateComm()}function save(){localStorage.setItem('fhv2',JSON.stringify({leads:S.leads,deals:S.deals,goal:S.goal}))}function showTab(t){document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));document.querySelectorAll('.nav-btn').forEach(x=>x.classList.remove('active'));document.getElementById(t+'Tab').classList.add('active');event.target.classList.add('active')}function toggleTracking(){S.tracking?stopTrack():startTrack()}function startTrack(){if(!navigator.geolocation){alert('GPS not supported');return}S.tracking=true;S.status='TRACKING';S.buf=[];S.watchId=navigator.geolocation.watchPosition(handlePos,handleErr,{enableHighAccuracy:true,timeout:10000,maximumAge:0});updateUI()}function stopTrack(){if(S.watchId){navigator.geolocation.clearWatch(S.watchId);S.watchId=null}S.tracking=false;S.status='IDLE';S.speed=null;S.dwellStart=null;S.dwellDur=0;updateUI()}function handlePos(p){const n={lat:p.coords.latitude,lon:p.coords.longitude,acc:p.coords.accuracy,ts:p.timestamp};S.pos=n;S.buf.push(n);if(S.buf.length>10)S.buf.shift();if(S.buf.length>=2){const pr=S.buf[S.buf.length-2];S.speed=calcSpd(pr,n)}const still=S.speed!==null&&S.speed<C.SPD;if(still){if(S.status==='TRACKING'){S.status='DWELLING';S.dwellStart=Date.now();S.dwellDur=0}else if(S.status==='DWELLING'){S.dwellDur=Date.now()-S.dwellStart;if(S.dwellDur>=C.DUR&&!S.capture)triggerCapture()}}else{if(S.status==='DWELLING'){S.status='TRACKING';S.dwellStart=null;S.dwellDur=0}}updateUI()}function handleErr(e){if(e.code===1)alert('Location denied');else if(e.code===2)alert('Position unavailable')}function calcSpd(a,b){const R=6371e3;const l1=a.lat*Math.PI/180;const l2=b.lat*Math.PI/180;const dL=(b.lat-a.lat)*Math.PI/180;const dO=(b.lon-a.lon)*Math.PI/180;const x=Math.sin(dL/2)**2+Math.cos(l1)*Math.cos(l2)*Math.sin(dO/2)**2;const c=2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));const d=R*c;const t=(b.ts-a.ts)/1000;if(t<=0)return 0;return Math.max(0,(d/t)*3600/C.MPM)}function triggerCapture(){S.status='CAPTURED';S.capture={id:'l_'+Date.now(),coords:{...S.pos},dur:S.dwellDur,ts:new Date().toISOString()};S.photos=[];S.comps=[];S.reminder=null;S.owner='unknown';if('vibrate'in navigator)navigator.vibrate([200,100,200]);revGeo(S.pos);document.getElementById('captureModal').classList.add('open');document.getElementById('captureDwell').textContent=fmtDur(S.dwellDur)+' at this location';document.getElementById('yearInput').value='';document.getElementById('sqftInput').value='';document.getElementById('notesInput').value='';document.getElementById('compInput').value='';document.getElementById('compList').innerHTML='';document.getElementById('previewBox').style.displayâ€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹
