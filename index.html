<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Field Hunter"><title>Field Hunter Pro</title><style>*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}:root{--orange:#f97316;--charcoal:#0a0a0a;--slate:#1a1a1a;--steel:#2a2a2a;--silver:#a3a3a3;--critical:#ef4444;--silicone:#3b82f6;--good:#22c55e}body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;background:var(--charcoal);color:#fff;min-height:100vh}.header{position:sticky;top:0;z-index:100;background:rgba(10,10,10,.95);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.1);padding:env(safe-area-inset-top) 16px 0}.header-content{display:flex;align-items:center;justify-content:space-between;padding:12px 0}.logo{display:flex;align-items:center;gap:12px}.logo-icon{width:44px;height:44px;background:var(--orange);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px}.logo-text h1{font-size:18px}.logo-text p{font-size:12px;color:var(--silver)}.tabs{display:flex;border-top:1px solid rgba(255,255,255,.1)}.tab{flex:1;padding:14px;background:0 0;border:none;color:var(--silver);font-size:14px;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;border-bottom:2px solid transparent}.tab.active{color:var(--orange);border-bottom-color:var(--orange)}.main{padding:20px}.radar-container{background:var(--slate);border-radius:20px;padding:24px;border:1px solid rgba(255,255,255,.1)}.radar-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}.radar-status{display:flex;align-items:center;gap:10px}.radar-dot{width:12px;height:12px;border-radius:50%;background:var(--steel)}.radar-dot.tracking{background:var(--silicone)}.radar-dot.dwelling{background:var(--orange);animation:pulse 1s infinite}.radar-dot.captured{background:var(--good)}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}.radar{position:relative;width:240px;height:240px;margin:0 auto 24px}.radar-circle{position:absolute;border-radius:50%;border:1px solid rgba(255,255,255,.1)}.radar-circle:nth-child(1){inset:0}.radar-circle:nth-child(2){inset:15%}.radar-circle:nth-child(3){inset:30%}.radar-circle:nth-child(4){inset:45%}.radar-sweep{position:absolute;top:50%;left:50%;width:50%;height:2px;transform-origin:left center;background:linear-gradient(90deg,rgba(59,130,246,.8) 0,transparent 100%);animation:sweep 2s linear infinite;display:none}.radar-sweep.active{display:block}.radar-sweep.dwelling{background:linear-gradient(90deg,rgba(249,115,22,.8) 0,transparent 100%)}@keyframes sweep{from{transform:rotate(0)}to{transform:rotate(360deg)}}.radar-center{position:absolute;inset:35%;border-radius:50%;background:var(--steel);display:flex;align-items:center;justify-content:center;font-size:32px}.radar-center.tracking{background:var(--silicone)}.radar-center.dwelling{background:var(--orange)}.radar-center.captured{background:var(--good)}.progress-ring{position:absolute;inset:-5%;transform:rotate(-90deg)}.progress-ring circle{fill:none;stroke-width:4;stroke-linecap:round}.progress-ring .bg{stroke:rgba(249,115,22,.2)}.progress-ring .progress{stroke:var(--orange)}.stats{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:24px}.stat{background:rgba(255,255,255,.05);border-radius:16px;padding:16px}.stat-label{font-size:11px;color:var(--silver);text-transform:uppercase;margin-bottom:4px}.stat-value{font-size:28px;font-weight:700}.stat-value span{font-size:14px;color:var(--silver)}.stat.full{grid-column:span 2}.stat.full .stat-value{font-size:16px}.stat-sub{font-size:12px;color:var(--silver);margin-top:4px}.control-btn{width:100%;padding:18px;border-radius:16px;border:none;font-size:18px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;min-height:60px}.control-btn.start{background:var(--orange);color:#fff}.control-btn.stop{background:rgba(239,68,68,.2);color:#ef4444;border:1px solid rgba(239,68,68,.5)}.leads-empty{text-align:center;padding:60px 20px}.leads-empty-icon{width:80px;height:80px;background:var(--steel);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:36px}.leads-empty h3{font-size:20px;margin-bottom:8px}.leads-empty p{color:var(--silver);font-size:14px}.lead-card{background:var(--slate);border-radius:20px;overflow:hidden;border:1px solid rgba(255,255,255,.1);margin-bottom:16px}.lead-header{padding:20px;position:relative}.lead-address{display:flex;gap:10px;padding-right:80px}.lead-address h3{font-size:18px;font-weight:600}.lead-address p{font-size:14px;color:var(--silver);margin-top:4px}.lead-stats{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px}.lead-stat{font-size:13px;color:var(--silver)}.lead-stat strong{color:#fff}.score-badge{position:absolute;top:16px;right:16px;width:70px;height:70px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center}.score-badge.critical{background:var(--critical);box-shadow:0 0 30px rgba(239,68,68,.5)}.score-badge.silicone{background:var(--silicone);box-shadow:0 0 30px rgba(59,130,246,.5)}.score-badge.good{background:var(--good);box-shadow:0 0 30px rgba(34,197,94,.5)}.score-badge .score{font-size:28px;font-weight:700}.score-badge .label{font-size:9px;font-weight:600}.roi-section{padding:0 20px;border-top:1px solid rgba(255,255,255,.1)}.roi-header{display:flex;align-items:center;justify-content:space-between;padding:16px 0;cursor:pointer}.roi-header strong{font-size:16px}.roi-details{padding-bottom:20px;display:none}.roi-details.open{display:block}.roi-option{border-radius:16px;padding:16px;margin-bottom:12px}.roi-option.tpo{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3)}.roi-option.silicone{background:rgba(34,197,94,.1);border:1px solid rgba(34,197,94,.3)}.roi-option-header{display:flex;justify-content:space-between;margin-bottom:10px}.roi-option.tpo .roi-option-title{color:#f87171}.roi-option.silicone .roi-option-title{color:#4ade80}.roi-option-title{font-weight:600}.roi-option-net{font-size:20px;font-weight:700}.roi-line{display:flex;justify-content:space-between;font-size:13px;color:var(--silver);margin-bottom:4px}.roi-note{font-size:12px;margin-top:8px;color:var(--silver)}.roi-option.silicone .roi-note{color:#4ade80;font-weight:500}.roi-summary{background:rgba(249,115,22,.2);border:1px solid rgba(249,115,22,.5);border-radius:16px;padding:16px;text-align:center}.roi-summary-label{font-size:12px;color:var(--orange)}.roi-summary-value{font-size:32px;font-weight:700;margin:4px 0}.roi-summary-sub{font-size:13px;color:var(--silver)}.lead-actions{padding:20px;border-top:1px solid rgba(255,255,255,.1)}.action-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.action-btn{background:var(--steel);border:none;border-radius:16px;padding:16px 12px;display:flex;flex-direction:column;align-items:center;gap:6px;color:var(--silver);min-height:70px}.action-btn .icon{font-size:24px}.action-btn .label{font-size:12px}.action-btn.primary{background:var(--orange);color:#fff}.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(8px);z-index:200;display:none;align-items:flex-end;justify-content:center;padding:16px}.modal-overlay.open{display:flex}.modal{background:var(--charcoal);border-radius:24px 24px 0 0;width:100%;max-width:500px;max-height:90vh;overflow-y:auto;padding-bottom:env(safe-area-inset-bottom)}.modal-header{position:sticky;top:0;background:var(--charcoal);padding:24px;border-bottom:1px solid rgba(255,255,255,.1);display:flex;align-items:center;justify-content:space-between}.modal-header-left{display:flex;align-items:center;gap:12px}.modal-icon{width:48px;height:48px;background:var(--good);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;animation:pulse 1s infinite}.modal-header h2{font-size:20px}.modal-header p{font-size:13px;color:var(--silver)}.modal-close{width:40px;height:40px;background:var(--steel);border:none;border-radius:50%;color:var(--silver);font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center}.modal-content{padding:24px}.modal-address{background:var(--slate);border-radius:16px;padding:16px;margin-bottom:24px}.modal-section h3{font-size:12px;color:var(--silver);text-transform:uppercase;margin-bottom:12px}.modal-input{width:100%;padding:16px;background:var(--steel);border:none;border-radius:16px;color:#fff;font-size:18px;margin-bottom:16px}.modal-input::placeholder{color:rgba(255,255,255,.3)}.modal-input:focus{outline:2px solid var(--orange)}.sqft-buttons{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:12px}.sqft-btn{padding:12px;background:var(--steel);border:none;border-radius:12px;color:var(--silver);font-size:14px;cursor:pointer}.sqft-btn.active{background:var(--orange);color:#fff}.modal-actions{padding:24px;border-top:1px solid rgba(255,255,255,.1)}.save-btn{width:100%;padding:18px;background:var(--good);border:none;border-radius:16px;color:#fff;font-size:18px;font-weight:600;margin-bottom:12px}.dismiss-btn{width:100%;padding:14px;background:0 0;border:none;color:var(--silver);font-size:16px}.preview-card{background:var(--slate);border-radius:16px;padding:16px;margin-top:20px}.preview-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}.preview-score{width:56px;height:56px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center}.preview-score .num{font-size:22px;font-weight:700}.preview-score .lbl{font-size:8px}.preview-roi{background:rgba(249,115,22,.15);border-radius:12px;padding:12px;text-align:center}.preview-roi-label{font-size:11px;color:var(--orange)}.preview-roi-value{font-size:24px;font-weight:700}.preview-roi-sub{font-size:11px;color:var(--silver)}.delete-btn{position:absolute;top:16px;left:16px;width:32px;height:32px;background:rgba(239,68,68,.2);border:none;border-radius:50%;color:#f87171;font-size:16px}</style></head><body><div id="app"><header class="header"><div class="header-content"><div class="logo"><div class="logo-icon">üéØ</div><div class="logo-text"><h1>Field Hunter Pro</h1><p>Dalmex Routes</p></div></div><div style="display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--steel);border-radius:20px;font-size:12px"><div class="radar-dot" id="statusDot"></div><span id="onlineStatus">Online</span></div></div><div class="tabs"><button class="tab active" id="radarTab" onclick="showTab('radar')">üìç Radar</button><button class="tab" id="leadsTab" onclick="showTab('leads')">üìã Leads (<span id="leadCount">0</span>)</button></div></header><main class="main" id="radarView"><div class="radar-container"><div class="radar-header"><div class="radar-status"><div class="radar-dot" id="radarDot"></div><span id="statusText">Ready to Hunt</span></div><div style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--silver)"><span id="connectionIcon">üì∂</span><span id="connectionText">Online</span></div></div><div class="radar"><div class="radar-circle"></div><div class="radar-circle"></div><div class="radar-circle"></div><div class="radar-circle"></div><div class="radar-sweep" id="radarSweep"></div><svg class="progress-ring" viewBox="0 0 100 100"><circle class="bg" cx="50" cy="50" r="45"/><circle class="progress" cx="50" cy="50" r="45" stroke-dasharray="283" stroke-dashoffset="283" id="progressCircle"/></svg><div class="radar-center" id="radarCenter">üß≠</div></div><div class="stats"><div class="stat"><div class="stat-label">‚ö° Speed</div><div class="stat-value"><span id="speedValue">--</span> <span>mph</span></div></div><div class="stat"><div class="stat-label">‚è± Dwell Time</div><div class="stat-value" id="dwellTime">0:00</div></div><div class="stat full" id="locationStat" style="display:none"><div class="stat-label">üìç Location</div><div class="stat-value" id="locationValue">--</div><div class="stat-sub" id="accuracyValue"></div></div></div><button class="control-btn start" id="controlBtn" onclick="toggleTracking()">üß≠ Start Route</button></div></main><main class="main" id="leadsView" style="display:none"><div id="leadsContainer"><div class="leads-empty" id="leadsEmpty"><div class="leads-empty-icon">üìç</div><h3>No Leads Yet</h3><p>Start your route and the app will capture leads when you stop.</p></div></div></main><div class="modal-overlay" id="captureModal"><div class="modal"><div class="modal-header"><div class="modal-header-left"><div class="modal-icon">üìç</div><div><h2>Lead Captured!</h2><p id="modalDwellTime">2m at this location</p></div></div><button class="modal-close" onclick="dismissCapture()">‚úï</button></div><div class="modal-content"><div class="modal-address"><strong id="addressText">Looking up address...</strong><p id="cityStateText" style="color:var(--silver);margin-top:4px"></p></div><div class="modal-section"><h3>Quick Assessment</h3><label style="display:block;font-size:14px;color:var(--silver);margin-bottom:8px">Year Built</label><input type="number" class="modal-input" id="yearInput" placeholder="e.g., 2005"><label style="display:block;font-size:14px;color:var(--silver);margin-bottom:8px">Roof Sqft</label><div class="sqft-buttons"><button class="sqft-btn" onclick="setSqft(5000)">5K</button><button class="sqft-btn" onclick="setSqft(10000)">10K</button><button class="sqft-btn" onclick="setSqft(20000)">20K</button><button class="sqft-btn" onclick="setSqft(50000)">50K</button></div><input type="number" class="modal-input" id="sqftInput" placeholder="Or enter exact"></div><div class="preview-card" id="previewCard" style="display:none"><div class="preview-header"><div><div style="font-weight:600" id="previewAddress">Address</div><div style="font-size:13px;color:var(--silver)" id="previewDetails"></div></div><div class="preview-score" id="previewScore"><div class="num">?</div><div class="lbl">SCORE</div></div></div><div class="preview-roi" id="previewROI" style="display:none"><div class="preview-roi-label">YEAR 1 SAVINGS</div><div class="preview-roi-value" id="previewSavings">$0</div><div class="preview-roi-sub">silicone vs TPO</div></div></div></div><div class="modal-actions"><button class="save-btn" onclick="saveLead()">‚úì Save Lead</button><button class="dismiss-btn" onclick="dismissCapture()">Dismiss</button></div></div></div></div><script>let state={status:'IDLE',isTracking:!1,currentPosition:null,currentSpeed:null,dwellStartTime:null,dwellDuration:0,capturedLeads:[],currentCapture:null,watchId:null,positionBuffer:[]};const CONFIG={DWELL_SPEED_THRESHOLD:2,DWELL_DURATION_THRESHOLD:120000,METERS_PER_MILE:1609.34};document.addEventListener('DOMContentLoaded',()=>{loadLeads();updateUI();window.addEventListener('online',()=>updateConnectionStatus(!0));window.addEventListener('offline',()=>updateConnectionStatus(!1));updateConnectionStatus(navigator.onLine);document.getElementById('yearInput').addEventListener('input',updatePreview);document.getElementById('sqftInput').addEventListener('input',updatePreview)});function toggleTracking(){state.isTracking?stopTracking():startTracking()}function startTracking(){if(!navigator.geolocation){alert('GPS not supported');return}state.isTracking=!0;state.status='TRACKING';state.positionBuffer=[];state.watchId=navigator.geolocation.watchPosition(handlePosition,handleGPSError,{enableHighAccuracy:!0,timeout:10000,maximumAge:0});updateUI()}function stopTracking(){if(state.watchId!==null){navigator.geolocation.clearWatch(state.watchId);state.watchId=null}state.isTracking=!1;state.status='IDLE';state.currentSpeed=null;state.dwellStartTime=null;state.dwellDuration=0;updateUI()}function handlePosition(position){const newPos={latitude:position.coords.latitude,longitude:position.coords.longitude,accuracy:position.coords.accuracy,timestamp:position.timestamp};state.currentPosition=newPos;state.positionBuffer.push(newPos);if(state.positionBuffer.length>10)state.positionBuffer.shift();if(state.positionBuffer.length>=2){const prev=state.positionBuffer[state.positionBuffer.length-2];state.currentSpeed=calculateSpeed(prev,newPos)}const isStationary=state.currentSpeed!==null&&state.currentSpeed<CONFIG.DWELL_SPEED_THRESHOLD;if(isStationary){if(state.status==='TRACKING'){state.status='DWELLING';state.dwellStartTime=Date.now();state.dwellDuration=0}else if(state.status==='DWELLING'){state.dwellDuration=Date.now()-state.dwellStartTime;if(state.dwellDuration>=CONFIG.DWELL_DURATION_THRESHOLD&&!state.currentCapture){triggerCapture()}}}else{if(state.status==='DWELLING'){state.status='TRACKING';state.dwellStartTime=null;state.dwellDuration=0}}updateUI()}function handleGPSError(error){let msg='GPS Error';if(error.code===1)msg='Location permission denied';if(error.code===2)msg='Position unavailable';if(error.code!==3)alert(msg)}function calculateSpeed(pos1,pos2){const R=6371e3;const lat1=pos1.latitude*Math.PI/180;const lat2=pos2.latitude*Math.PI/180;const dLat=(pos2.latitude-pos1.latitude)*Math.PI/180;const dLon=(pos2.longitude-pos1.longitude)*Math.PI/180;const a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(lat1)*Math.cos(lat2)*Math.sin(dLon/2)*Math.sin(dLon/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));const distance=R*c;const timeSeconds=(pos2.timestamp-pos1.timestamp)/1000;if(timeSeconds<=0)return 0;return Math.max(0,(distance/timeSeconds)*3600/CONFIG.METERS_PER_MILE)}function triggerCapture(){state.status='CAPTURED';state.currentCapture={id:'lead_'+Date.now(),coordinates:{...state.currentPosition},dwellDuration:state.dwellDuration,timestamp:new Date().toISOString()};if('vibrate'in navigator)navigator.vibrate([200,100,200]);reverseGeocode(state.currentPosition);document.getElementById('captureModal').classList.add('open');document.getElementById('modalDwellTime').textContent=formatDuration(state.dwellDuration)+' at this location';document.getElementById('yearInput').value='';document.getElementById('sqftInput').value='';document.querySelectorAll('.sqft-btn').forEach(b=>b.classList.remove('active'));document.getElementById('previewCard').style.display='none';updateUI()}async function reverseGeocode(coords){const addressEl=document.getElementById('addressText');const cityStateEl=document.getElementById('cityStateText');addressEl.textContent='Looking up address...';cityStateEl.textContent='';try{const response=await fetch('https://nominatim.openstreetmap.org/reverse?format=json&lat='+coords.latitude+'&lon='+coords.longitude);const data=await response.json();if(data&&data.display_name){const parts=data.display_name.split(', ');addressEl.textContent=parts.slice(0,2).join(', ');cityStateEl.textContent=parts.slice(2,5).join(', ');if(state.currentCapture)state.currentCapture.address=data.display_name}else{addressEl.textContent=coords.latitude.toFixed(6)+', '+coords.longitude.toFixed(6);cityStateEl.textContent='Address unavailable'}}catch(e){addressEl.textContent=coords.latitude.toFixed(6)+', '+coords.longitude.toFixed(6);cityStateEl.textContent='Offline'}updatePreview()}function setSqft(value){document.getElementById('sqftInput').value=value;document.querySelectorAll('.sqft-btn').forEach(b=>{b.classList.toggle('active',parseInt(b.textContent)*1000===value)});updatePreview()}function updatePreview(){const year=document.getElementById('yearInput').value?parseInt(document.getElementById('yearInput').value):null;const sqft=document.getElementById('sqftInput').value?parseInt(document.getElementById('sqftInput').value):null;const score=calculateScore(year,sqft);document.getElementById('previewCard').style.display='block';document.getElementById('previewAddress').textContent=document.getElementById('addressText').textContent;let details=[];if(year)details.push('Built '+year+' ('+(new Date().getFullYear()-year)+' yrs)');if(sqft)details.push(sqft.toLocaleString()+' sqft');document.getElementById('previewDetails').textContent=details.join(' ‚Ä¢ ');const scoreBadge=document.getElementById('previewScore');scoreBadge.querySelector('.num').textContent=score.value;scoreBadge.querySelector('.lbl').textContent=score.label;scoreBadge.style.background=score.color;scoreBadge.style.boxShadow='0 0 20px '+score.color+'66';const roiSection=document.getElementById('previewROI');if(sqft){const roi=calculateROI(sqft);roiSection.style.display='block';document.getElementById('previewSavings').textContent='$'+roi.savings.toLocaleString()}else{roiSection.style.display='none'}if(state.currentCapture){state.currentCapture.yearBuilt=year;state.currentCapture.sqft=sqft;state.currentCapture.score=score}}function calculateScore(year,sqft){const age=year?new Date().getFullYear()-year:null;let points=0;if(age!==null){if(age>=20)points+=4;else if(age>=10&&age<=15)points+=2}if(age&&age>10)points+=3;if(sqft&&sqft>20000)points+=1;const value=Math.min(10,Math.max(1,points));let label,color;if(value>=8){label='CRITICAL';color='#ef4444'}else if(value>=5){label
return{tpoNet:Math.round(tpoNet),siliconeNet:Math.round(siliconeNet),savings:Math.round(tpoNet-siliconeNet)}}function saveLead(){if(!state.currentCapture)return;const lead={...state.currentCapture,yearBuilt:parseInt(document.getElementById('yearInput').value)||null,sqft:parseInt(document.getElementById('sqftInput').value)||null,score:calculateScore(parseInt(document.getElementById('yearInput').value),parseInt(document.getElementById('sqftInput').value)),address:document.getElementById('addressText').textContent};if(lead.sqft)lead.roi=calculateROI(lead.sqft);state.capturedLeads.unshift(lead);saveLeads();dismissCapture();showTab('leads')}function dismissCapture(){document.getElementById('captureModal').classList.remove('open');state.currentCapture=null;state.status='TRACKING';state.dwellStartTime=null;state.dwellDuration=0;updateUI()}function saveLeads(){localStorage.setItem('fieldHunterLeads',JSON.stringify(state.capturedLeads));updateLeadCount();renderLeads()}function loadLeads(){const saved=localStorage.getItem('fieldHunterLeads');if(saved)state.capturedLeads=JSON.parse(saved);updateLeadCount();renderLeads()}function deleteLead(id){state.capturedLeads=state.capturedLeads.filter(l=>l.id!==id);saveLeads()}function updateLeadCount(){document.getElementById('leadCount').textContent=state.capturedLeads.length}function renderLeads(){const container=document.getElementById('leadsContainer');const empty=document.getElementById('leadsEmpty');if(state.capturedLeads.length===0){container.innerHTML='';container.appendChild(empty);empty.style.display='block';return}empty.style.display='none';container.innerHTML=state.capturedLeads.map(lead=>{const score=lead.score||{value:'?',label:'CHECK',color:'#2a2a2a'};const scoreClass=score.label==='CRITICAL'?'critical':score.label==='SILICONE'?'silicone':'good';return'<div class="lead-card"><div class="lead-header"><button class="delete-btn" onclick="deleteLead(\''+lead.id+'\')">üóë</button><div class="lead-address"><span style="color:var(--orange);font-size:20px">üìç</span><div><h3>'+(lead.address||'Unknown')+'</h3></div></div><div class="score-badge '+scoreClass+'"><span class="score">'+score.value+'</span><span class="label">'+score.label+'</span></div><div class="lead-stats">'+(lead.yearBuilt?'<span class="lead-stat">üóì <strong>'+lead.yearBuilt+'</strong> ('+(new Date().getFullYear()-lead.yearBuilt)+' yrs)</span>':'')+(lead.sqft?'<span class="lead-stat">üè¢ <strong>'+lead.sqft.toLocaleString()+'</strong> sqft</span>':'')+'</div></div>'+(lead.roi?'<div class="roi-section"><div class="roi-header" onclick="this.nextElementSibling.classList.toggle(\'open\')"><div style="display:flex;align-items:center;gap:10px"><span style="color:var(--good)">üí∞</span><strong>Year 1 Savings: $'+lead.roi.savings.toLocaleString()+'</strong></div><span>‚ñº</span></div><div class="roi-details"><div class="roi-option tpo"><div class="roi-option-header"><span class="roi-option-title">TPO Replacement</span><span class="roi-option-net">$'+lead.roi.tpoNet.toLocaleString()+'</span></div><div class="roi-line"><span>Gross</span><span>$'+(lead.sqft*12).toLocaleString()+'</span></div><div class="roi-note">39-year depreciation</div></div><div class="roi-option silicone"><div class="roi-option-header"><span class="roi-option-title">Silicone Coating</span><span class="roi-option-net">$'+lead.roi.siliconeNet.toLocaleString()+'</span></div><div class="roi-line"><span>Gross</span><span>$'+(lead.sqft*4).toLocaleString()+'</span></div><div class="roi-note">‚úì 100% deductible</div></div><div class="roi-summary"><div class="roi-summary-label">YEAR 1 ADVANTAGE</div><div class="roi-summary-value">$'+lead.roi.savings.toLocaleString()+'</div><div class="roi-summary-sub">'+Math.round((lead.roi.savings/lead.roi.tpoNet)*100)+'% savings</div></div></div></div>':'')+'<div class="lead-actions"><div class="action-grid"><button class="action-btn"><span class="icon">üì∑</span><span class="label">Photo</span></button><button class="action-btn primary"><span class="icon">üìÑ</span><span class="label">Proposal</span></button><button class="action-btn"><span class="icon">üìû</span><span class="label">Call</span></button></div></div></div>'}).join('')}function showTab(tab){document.getElementById('radarTab').classList.toggle('active',tab==='radar');document.getElementById('leadsTab').classList.toggle('active',tab==='leads');document.getElementById('radarView').style.display=tab==='radar'?'block':'none';document.getElementById('leadsView').style.display=tab==='leads'?'block':'none'}function updateConnectionStatus(online){document.getElementById('connectionIcon').textContent=online?'üì∂':'üì°';document.getElementById('connectionText').textContent=online?'Online':'Offline';document.getElementById('onlineStatus').textContent=online?'Online':'Offline'}function updateUI(){const statusDot=document.getElementById('statusDot');const radarDot=document.getElementById('radarDot');const statusText=document.getElementById('statusText');const radarCenter=document.getElementById('radarCenter');const radarSweep=document.getElementById('radarSweep');const controlBtn=document.getElementById('controlBtn');const progressCircle=document.getElementById('progressCircle');const locationStat=document.getElementById('locationStat');statusDot.className='radar-dot';radarDot.className='radar-dot';radarCenter.className='radar-center';radarSweep.className='radar-sweep';switch(state.status){case'IDLE':statusText.textContent='Ready to Hunt';radarCenter.textContent='üß≠';break;case'TRACKING':statusDot.classList.add('tracking');radarDot.classList.add('tracking');radarCenter.classList.add('tracking');radarSweep.classList.add('active');statusText.textContent='En Route';radarCenter.textContent='üß≠';break;case'DWELLING':statusDot.classList.add('dwelling');radarDot.classList.add('dwelling');radarCenter.classList.add('dwelling');radarSweep.classList.add('active','dwelling');statusText.textContent='Potential Stop...';radarCenter.textContent='üì°';break;case'CAPTURED':statusDot.classList.add('captured');radarDot.classList.add('captured');radarCenter.classList.add('captured');statusText.textContent='Lead Captured!';radarCenter.textContent='üéØ';break}controlBtn.className=state.isTracking?'control-btn stop':'control-btn start';controlBtn.innerHTML=state.isTracking?'‚ñ† Stop Tracking':'üß≠ Start Route';document.getElementById('speedValue').textContent=state.currentSpeed!==null?state.currentSpeed.toFixed(1):'--';document.getElementById('dwellTime').textContent=formatDuration(state.dwellDuration);const progress=Math.min(100,(state.dwellDuration/CONFIG.DWELL_DURATION_THRESHOLD)*100);const circumference=2*Math.PI*45;progressCircle.style.strokeDashoffset=circumference-(progress/100)*circumference;if(state.currentPosition){locationStat.style.display='block';document.getElementById('locationValue').textContent=state.currentPosition.latitude.toFixed(6)+', '+state.currentPosition.longitude.toFixed(6);document.getElementById('accuracyValue').textContent='¬±'+Math.round(state.currentPosition.accuracy)+'m'}updateLeadCount()}function formatDuration(ms){const totalSeconds=Math.floor(ms/1000);const minutes=Math.floor(totalSeconds/60);const seconds=totalSeconds%60;return minutes+':'+seconds.toString().padStart(2,'0')}</script></body></html>i
